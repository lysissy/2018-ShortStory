# 关于数据重组

#### 事情的起源
在处理存储表单数据的时候遇到了一些麻烦。页面结构：表单>表格。每单元行表单元素一致。<br>
原本打算表单提交的时候，通过表单数据的$form.serialasArray()做一下数据重组。后来发现被disabled的表单元素，提交表单信息时被自动忽略。见参考资料1<br>
checkbox类型的值也未被记录在表单数据中，于是萌生想试试看能不能有什么方法把不规律的字符串重组为符合规律的数组的想法。<br>
HERE WE GO~

### 问题描述
> 数组中有一些无序字符串，如["b", "a", "b", "a", "c", "b"]，<br>
如何在现有数组的基础上，通过插入数据的方法，使其按["a", "b", "c"]这样的规律排列？

### 实现的思路
1. 设置一个缓存数组用来存储最后的返回结果。
2. 把原始数组中的数据处理为连续的纯数字的形式来代表各种状态，比如：0 代表 "a", 1 代表 "b" 这样。<br>
因为在Javascript中，只有数字大小的比较操作才准确。我把这转换后的数组称为状态数组。
3. <b></b>在循环的过程中，把无序的状态数组通过对比插入的方式调整为有序的状态数组。核心代码如下：
```javascript
for (var j = 1, count; j < status.length; ){
    // 如果(pre+1)%len 和当前项相同，则顺利迭代，不需要处理，否则需要矫正、补全数据
    if(  (status[j-1]+1)%rules_len === status[j]  ){
        j++;
    } else {
        // 如果不符合要求，需要补全数据，j指针不能迭代！！！！
        status.splice(j, 0, (status[j-1]+1)%rules_len );
    }
}
```
4. 根据有序的状态数组，按照对应规则，还原字符串数组。
5. 修补初始数据和末尾数据不完整的情况。

> 详细代码可查看2018-PracticeDemos/0206-Data-Reconstruct/index.html

### 总结反思
* Javascript中的枚举是什么？
* 在讨论的过程中，有提到过`状态机`这样的概念，需要补充学习一下。<br>
拿数字状态去映射各种不同的数据，比起直接操作数据简化了许多。避免了很多数据操作上的局限性。
* 在for循环中，经常都是i++这样的迭代，却忘记了循环本身的意义。迭代规则也可以写在{}花括号内哦～
* 数组在Javascript中有很多神奇的用法，所以更需要深入了解其中的操作方法、迭代器、指针 各种基础知识。


##### 不重要的小事
* 在实际业务中并未真正的使用这样数据重组的方法去做，而是把数据捆绑在了元素上，操作的过程中修改存储的数据信息。
* 谈起开头的那些不被FormData记录下来的数据，有人提供了readonly的属性。这样就可以被记录下数据了，有兴趣的可以试一试。


###### 参考资料
* [&lt;input type=&#34;checkbox&#34;&gt; - HTML（超文本标记语言） | MDN](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/Input/checkbox);
* [JavaScript与有限状态机 - 阮一峰的网络日志](http://www.ruanyifeng.com/blog/2013/09/finite-state_machine_for_javascript.html)